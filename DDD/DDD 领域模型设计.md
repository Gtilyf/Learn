# DDD 领域模型设计

- 业务逻辑被合理的分散到不同的领域对象中，代码结构更加清晰，可读性，可维护性更高。
- 对象职责更加单一，内聚度更高。
- 复杂的业务模型可以通过领域建模（UML是一种主要方式）清晰的表达，开发人员甚至可以在不读源码的情况下就能了解业务和系统结构，这有利于对现存的系统进行维护和迭代开发。
- 系统高度模块化，代码重用度高，不会出现太多的重复逻辑。

领域模型的建立：

> Tips: 设计领域模型的时候，一定要抛开持久化的考虑，即：不考虑数据库表的设计，以及持久化的实现；
> 
> 1. 数据库表的设计一定是在最后阶段，根据设计好的领域模型去进行设计的；
> 2. 持久化的实现方案的选择也是一样，应当在领域模型设计完成后再去考虑的；我们使用jpa的原因：jpa相对 与mybatis来说，使用其实体类的关联关系（eg: oneToMany），可以让我们更加方便的去实现聚合根的持久化；
> 3. **领域模型的设计是根据业务逻辑来进行的**，简单来说就是一块业务逻辑对应一个**聚合根**，聚合根中聚合了该业务逻辑所需要管理的信息，这些信息即是我们所说的**实体**与**值对象**；

1. 划分领域
   
   我的理解是：划分领域其实就是区分清楚各个业务逻辑的性质，同一性质的业务逻辑就属于同一领域；一个领域服务的性质大致包含两个方面：a. 业务逻辑，即它实现的功能是什么，可以提供的服务是什么，b. 领域需要管理的业务数据，在这个业务逻辑中，能获取的以及会被修改到的数据;
   
   一个比较简单的方法就是**看这些业务逻辑需要管理的业务数据是否相同**，基本上来说**一块业务逻辑对应一个聚合根，即一个子域**； 
   
   多个子域相互合作，构成一个大的领域，即我们所说的**微服务**;

2. 设计聚合根
   
   聚合根负责实现该子域的业务逻辑，以及管理该子域需要的业务数据；针对这些业务数据我们可以抽象出我们的**领域对象**，比如我们的PatientCourse聚合根

3. 聚合根的持久化
   
   实体的持久化由聚合根管理；
   
   值对象的持久化分两种：
   
   ​    a. 业务逻辑需要保存的信息：可以分散到根实体中的某几列中去，也可以序列化保存一个大json
   
   ​    b. 业务不需要保存的信息：获取方式 ，基本上是由其他的领域服务提供

领域服务（service）：

​    组合单个或多个领域服务，对外提供服务接口
